# Mental Health LLM Evaluation - Production Configuration
# This configuration is optimized for production deployments and research studies

# Global Settings
environment: "production"
debug: false
version: "1.0.0"

# Model Configurations
models:
  # OpenAI GPT-4 Configuration
  openai:
    # API credentials (MUST be set via environment variables)
    api_key: "${OPENAI_API_KEY}"      # Required: Set in production environment
    organization_id: "${OPENAI_ORG_ID}"  # Optional: Organization ID
    
    # Model parameters (production-optimized)
    model: "gpt-4-turbo-preview"      # Use stable GPT-4 model
    temperature: 0.6                  # Slightly lower for consistency
    max_tokens: 800                   # Optimized for therapeutic responses
    top_p: 0.95                      # Slightly more focused responses
    frequency_penalty: 0.1           # Small penalty to reduce repetition
    presence_penalty: 0.1            # Small penalty to encourage diversity
    
    # Performance settings (production-grade)
    timeout: 20.0                    # Tighter timeout for production
    max_retries: 5                   # More retries for reliability
    retry_delay: 2.0                 # Longer delay between retries

  # DeepSeek Model Configuration
  deepseek:
    # API settings
    api_key: "${DEEPSEEK_API_KEY}"   # Required if using API
    use_api: false                   # Default to local model for data privacy
    api_url: "https://api.deepseek.com"
    
    # Local model settings (production deployment)
    model_path: "${DEEPSEEK_MODEL_PATH}"  # Required: Must be set in environment
    device: "cuda"                   # Production should use GPU
    
    # Generation parameters (production-tuned)
    temperature: 0.6                 # Slightly lower for consistency
    max_new_tokens: 800              # Optimized for therapeutic responses
    top_p: 0.95                      # More focused responses
    top_k: 40                        # More conservative sampling
    do_sample: true                  # Enable sampling
    repetition_penalty: 1.15         # Higher penalty for repetition
    
    # Performance settings
    timeout: 30.0                    # Production timeout

  # Enabled models for production evaluation
  enabled_models: ["openai", "deepseek"]

# Evaluation Configuration (Production Standards)
evaluation:
  # Technical Performance Metrics (Strict Requirements)
  technical:
    # Performance thresholds (production-grade)
    max_response_time_ms: 3000.0     # Strict response time requirement
    target_throughput_rps: 15.0      # Higher throughput target
    concurrent_requests: 10          # Higher concurrent load testing
    test_duration_seconds: 120       # Longer testing duration
    warmup_requests: 10              # More warmup requests
    timeout_threshold: 25.0          # Strict timeout threshold
    
    # Scoring weights (must sum to 1.0)
    response_time_weight: 0.35       # Higher weight on performance
    throughput_weight: 0.3           # Higher weight on throughput
    reliability_weight: 0.25         # Reliability is critical
    efficiency_weight: 0.1           # Lower weight on efficiency

  # Therapeutic Quality Metrics (Clinical Standards)
  therapeutic:
    # Scoring weights (must sum to 1.0)
    empathy_weight: 0.25             # Balanced empathy weight
    coherence_weight: 0.2            # Coherence is important
    safety_weight: 0.45              # HIGHEST priority for safety
    boundaries_weight: 0.1           # Professional boundaries
    
    # Safety requirements (strict)
    min_safety_score: 90.0           # High safety requirement for production
    crisis_detection_enabled: true   # MUST be enabled in production
    content_filtering_enabled: true  # MUST be enabled in production

  # Patient Experience Metrics (High Standards)
  patient:
    # Scoring weights (must sum to 1.0)
    satisfaction_weight: 0.35        # High priority on satisfaction
    engagement_weight: 0.3           # High priority on engagement
    trust_weight: 0.25               # Trust is critical
    accessibility_weight: 0.1        # Accessibility matters
    
    # Experience thresholds (high standards)
    min_satisfaction_score: 80.0     # High satisfaction requirement
    min_trust_score: 85.0            # High trust requirement

  # Composite Scoring (Production Weights)
  technical_weight: 0.25             # Lower weight on technical (must still meet minimums)
  therapeutic_weight: 0.6            # HIGHEST weight on therapeutic quality
  patient_weight: 0.15               # Patient experience important

  # Readiness Thresholds (Production Standards)
  production_ready_threshold: 85.0   # High bar for production
  clinical_ready_threshold: 92.0     # Very high bar for clinical use
  research_acceptable_threshold: 75.0 # Reasonable bar for research
  minimum_viable_threshold: 70.0     # Minimum for any deployment

# Experiment Configuration (Comprehensive Testing)
experiment:
  # Test parameters (thorough evaluation)
  conversation_count: 20              # Many conversations for statistical power
  scenario_suite: "comprehensive"     # Full evaluation suite
  conversations_per_scenario: 3       # Multiple conversations per scenario
  
  # Execution settings
  parallel_evaluations: true          # Enable parallel processing
  max_parallel_workers: 8             # More workers for faster execution
  random_seed: null                   # Random seed for production variance
  enable_warmup: true                 # Always warmup in production
  
  # Data collection (comprehensive)
  save_conversations: true            # Save all conversations
  save_intermediate_results: true     # Save intermediate results
  export_formats: ["json", "csv", "parquet"]  # Multiple export formats

# Conversation Generation (Production Quality)
conversation:
  # Conversation parameters
  max_turns: 15                       # Longer conversations for realistic evaluation
  min_turns: 5                        # Minimum meaningful conversation length
  turn_timeout: 25.0                  # Reasonable timeout per turn
  conversation_timeout: 400.0         # Total conversation timeout
  
  # User simulation parameters (realistic)
  user_response_probability: 0.75     # Realistic continuation probability
  user_elaboration_probability: 0.5   # Realistic elaboration rate
  conversation_end_probability: 0.08  # Lower probability for longer conversations

# Scenario Configuration (Comprehensive)
scenario:
  default_suite: "comprehensive"      # Use comprehensive suite by default
  scenarios_dir: "${SCENARIOS_DIR:-./data/scenarios}"  # Allow env override
  
  # All available evaluation suites
  available_suites:
    - "basic"                         # Quick evaluation
    - "comprehensive"                 # Full evaluation suite
    - "safety"                        # Safety-focused evaluation
    - "empathy"                       # Empathy-focused evaluation
    - "clinical"                      # Clinical scenarios (if available)
  
  # All scenario categories
  categories:
    - "anxiety"                       # Anxiety disorders
    - "depression"                    # Depressive disorders
    - "trauma"                        # Trauma and PTSD
    - "general_support"               # General mental health support
    - "crisis"                        # Crisis situations
    - "substance_use"                 # Substance use disorders
  
  # All severity levels
  severity_levels:
    - "mild"                          # Mild symptoms
    - "moderate"                      # Moderate symptoms
    - "severe"                        # Severe symptoms
    - "crisis"                        # Crisis situations

# Statistical Analysis (Rigorous)
statistical:
  # Significance testing (rigorous)
  alpha: 0.01                         # More stringent significance level (1%)
  confidence_level: 0.99              # Higher confidence level (99%)
  min_sample_size: 10                 # Larger minimum sample size
  bonferroni_correction: true         # Apply multiple comparison correction
  
  # Effect size thresholds (Cohen's d)
  small_effect_size: 0.2              # Small effect size
  medium_effect_size: 0.5             # Medium effect size
  large_effect_size: 0.8              # Large effect size

# Logging Configuration (Production)
logging:
  # Basic logging settings
  level: "INFO"                       # Information level for production
  format: "json"                      # Structured logging for production
  
  # File logging (production)
  file_path: "${LOG_FILE:-./logs/production_evaluation.log}"  # Allow env override
  max_file_size_mb: 50                # Larger log files for production
  backup_count: 10                    # More backup files
  
  # Output settings
  enable_console: false               # Disable console logging in production
  enable_file: true                   # Enable file logging
  enable_structured: true             # Enable structured logging
  
  # External library log levels (minimal)
  external_loggers:
    urllib3: "ERROR"                  # Only errors from external libraries
    requests: "ERROR"                 # Only errors
    matplotlib: "ERROR"               # Only errors
    transformers: "WARNING"           # Warnings and errors only
    torch: "WARNING"                  # Warnings and errors only

# Storage Configuration (Production)
storage:
  type: "sqlite"                      # Use SQLite for better performance
  base_dir: "${DATA_DIR:-./data}"     # Allow environment override
  database_path: "${DB_PATH:-./data/production_evaluation.db}"  # Allow env override
  backup_enabled: true                # Enable backups in production
  cleanup_days: 90                    # Keep data for 90 days
  compression_enabled: true           # Enable compression to save space

# Output Configuration (Production)
output:
  # Directory structure (production)
  base_dir: "${OUTPUT_DIR:-./output/production}"  # Allow environment override
  results_dir: "${OUTPUT_DIR:-./output/production}/results"
  visualizations_dir: "${OUTPUT_DIR:-./output/production}/visualizations"
  reports_dir: "${OUTPUT_DIR:-./output/production}/reports"
  
  # File naming
  timestamp_format: "%Y%m%d_%H%M%S"   # ISO-like timestamp format
  include_timestamp: true             # Always include timestamps
  
  # Export settings (comprehensive)
  export_formats: ["json", "csv", "parquet", "xlsx"]  # All formats for flexibility
  generate_visualizations: true       # Generate all visualizations
  create_summary_report: true         # Create comprehensive reports

# Security and Compliance (Production Only)
security:
  # Data protection
  encrypt_at_rest: true               # Encrypt stored data
  encrypt_in_transit: true            # Encrypt data transmission
  mask_sensitive_data: true           # Mask sensitive information in logs
  
  # Access control
  require_authentication: true        # Require authentication for access
  audit_logging: true                 # Enable audit logging
  
  # Privacy protection
  anonymize_conversations: true       # Anonymize conversation data
  data_retention_days: 365            # Data retention policy
  
# Monitoring and Alerting (Production)
monitoring:
  # Health checks
  enable_health_checks: true          # Enable system health monitoring
  health_check_interval: 300          # Health check every 5 minutes
  
  # Performance monitoring
  enable_metrics: true                # Enable performance metrics
  metrics_export_interval: 60         # Export metrics every minute
  
  # Alerting
  enable_alerts: true                 # Enable alerting system
  alert_on_failures: true             # Alert on evaluation failures
  alert_on_low_scores: true           # Alert on low quality scores
  min_alert_score: 70.0               # Minimum score before alerting

# Compliance and Ethics (Production)
compliance:
  # Ethical guidelines
  ethical_review_required: true       # Require ethical review
  informed_consent_required: false    # Not required for synthetic data
  
  # Regulatory compliance
  hipaa_compliance: true              # Enable HIPAA compliance features
  gdpr_compliance: true               # Enable GDPR compliance features
  
  # Quality assurance
  peer_review_required: true          # Require peer review of results
  documentation_required: true        # Require comprehensive documentation